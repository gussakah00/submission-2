const CACHE_NAME="submission-2-v1",API_BASE="https://story-api.dicoding.dev/v1",STATIC_CACHE_URLS=["/submission-2/","/submission-2/index.html","/submission-2/app.bundle.js","/submission-2/app.css","/submission-2/manifest.json","/submission-2/favicon.png"];self.addEventListener("install",(e=>{console.log("Service Worker installing..."),e.waitUntil(caches.open(CACHE_NAME).then((e=>(console.log("Caching app shell..."),e.addAll(STATIC_CACHE_URLS).catch((e=>{console.warn("Some files failed to cache:",e)}))))).then((()=>self.skipWaiting())))})),self.addEventListener("activate",(e=>{console.log("Service Worker activating..."),e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{if(e!==CACHE_NAME)return console.log("Deleting old cache:",e),caches.delete(e)}))))).then((()=>self.clients.claim())))})),self.addEventListener("fetch",(e=>{const{request:t}=e;"GET"===t.method&&(t.url.startsWith("chrome-extension://")||e.respondWith(caches.match(t).then((e=>e||fetch(t).then((e=>{if(200===e.status){const i=e.clone();caches.open(CACHE_NAME).then((e=>{e.put(t,i)}))}return e})).catch((()=>{if(t.headers.get("accept").includes("text/html"))return caches.match("./index.html")}))))))})),self.addEventListener("push",(e=>{console.log("Push event received:",e),e.waitUntil(self.registration.showNotification("Cerita di Sekitarmu",{body:"Ada cerita baru di sekitarmu!",icon:"./favicon.png",badge:"./favicon.png",data:{url:"./#/beranda"},actions:[{action:"open",title:"Buka Aplikasi"},{action:"close",title:"Tutup"}]}))})),self.addEventListener("notificationclick",(e=>{e.notification.close(),"open"===e.action&&e.waitUntil(clients.openWindow(e.notification.data.url))}));